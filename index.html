<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Perception Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 40px;
        }
        
        h1 {
            color: #1f2937;
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .subtitle {
            color: #6b7280;
            margin-bottom: 24px;
        }
        
        .info-box {
            background: #e8edf7;
            border-left: 4px solid #081F5D;
            padding: 16px;
            margin-bottom: 24px;
            font-size: 0.9rem;
            color: #374151;
        }
        
        .progress-container {
            margin-bottom: 32px;
        }
        
        .progress-text {
            text-align: center;
            color: #6b7280;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .progress-bar-outer {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-bar-inner {
            height: 100%;
            background: #081F5D;
            transition: width 0.3s ease;
        }
        
        .comparison-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 24px;
        }
        
        .comparison-question {
            text-align: center;
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 32px;
        }
        
        .choice-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 0;
        }
        
        .choice-option {
            background: #f9fafb;
            border: 3px solid #e5e7eb;
            border-radius: 12px;
            padding: 32px;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
            min-height: 160px;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .choice-option:hover {
            border-color: #081F5D;
            background: #e8edf7;
            transform: scale(1.02);
            box-shadow: 0 8px 16px rgba(8, 31, 93, 0.15);
        }
        
        .choice-option:active {
            transform: scale(0.98);
        }
        
        .choice-option.selected {
            border-color: #081F5D;
            background: #081F5D;
            color: white;
            animation: select-pulse 0.3s ease;
        }
        
        @keyframes select-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .choice-text {
            font-size: 1.05rem;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .choice-label {
            display: block;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 16px;
            color: #9ca3af;
        }
        
        .choice-option.selected .choice-label {
            color: rgba(255,255,255,0.9);
        }
        
        .next-button {
            display: none;
        }
        
        #assessment {
            display: block;
        }
        
        #results {
            display: none;
        }
        
        .power-card {
            border: 2px solid;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .power-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .power-title-section {
            display: flex;
            align-items: center;
        }
        
        .color-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 12px;
        }
        
        .power-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        .power-source {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .power-score {
            text-align: right;
        }
        
        .score-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
        }
        
        .score-total {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .power-description {
            font-style: italic;
            color: #374151;
            margin-bottom: 16px;
            font-size: 0.9rem;
        }
        
        .progress-bar-container {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            margin-right: 16px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            transition: width 0.3s;
        }
        
        .interpretation {
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .questions-box {
            background: #f9fafb;
            border-radius: 6px;
            padding: 16px;
            margin-top: 12px;
        }
        
        .questions-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }
        
        .questions-list {
            list-style: none;
        }
        
        .questions-list li {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 6px;
            display: flex;
        }
        
        .questions-list li:before {
            content: "‚Ä¢";
            margin-right: 8px;
        }
        
        .reflection-box {
            background: #fffbeb;
            border: 1px solid #fde68a;
            border-radius: 8px;
            padding: 24px;
            margin-top: 32px;
        }
        
        .reflection-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 12px;
        }
        
        .reflection-list {
            list-style: none;
        }
        
        .reflection-list li {
            color: #374151;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .reflection-list li:before {
            content: "‚Ä¢";
            margin-right: 8px;
        }
        
        #radarChart {
            display: block;
            margin: 0 auto;
            max-width: 500px;
            width: 100%;
            height: auto;
        }
        
        @media print {
            #assessment {
                display: none !important;
            }
            
            #results {
                display: block !important;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }
            
            button {
                display: none !important;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .subtitle {
                font-size: 0.875rem;
            }
            
            .choice-option {
                min-height: 140px;
                padding: 24px 16px;
            }
            
            .choice-text {
                font-size: 0.95rem;
            }
            
            .comparison-question {
                font-size: 1rem;
            }
            
            .power-card {
                padding: 16px;
            }
            
            .power-header {
                flex-direction: column;
                gap: 12px;
            }
            
            .power-name {
                font-size: 1rem;
            }
            
            .score-number {
                font-size: 1.5rem;
            }
            
            .power-description {
                font-size: 0.85rem;
            }
            
            #radarChart {
                max-width: 100%;
            }
            
            .reflection-box {
                padding: 16px;
            }
            
            .reflection-list li {
                font-size: 0.85rem;
            }
            
            .next-button {
                font-size: 1rem !important;
                padding: 14px 24px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Power Perception Assessment</h1>
        <p class="subtitle">Based on French & Raven's Bases of Social Power, with contemporary additions</p>
        
        <div id="assessment">
            <div class="info-box">
                For each comparison, choose the statement that is <strong>MORE true</strong> for you in your current role. 
                There are no right or wrong answers - just select whichever statement better describes you.
            </div>
            
            <div class="progress-container">
                <div class="progress-text"><span id="current-pair">1</span> of <span id="total-pairs">0</span></div>
                <div class="progress-bar-outer">
                    <div class="progress-bar-inner" id="progress-bar"></div>
                </div>
            </div>
            
            <div class="comparison-card">
                <div class="comparison-question">Which statement is MORE true for you?</div>
                
                <div class="choice-container">
                    <div class="choice-option" id="option-a" onclick="selectOption('a')">
                        <div>
                            <span class="choice-label">Option A</span>
                            <div class="choice-text" id="statement-a"></div>
                        </div>
                    </div>
                    
                    <div class="choice-option" id="option-b" onclick="selectOption('b')">
                        <div>
                            <span class="choice-label">Option B</span>
                            <div class="choice-text" id="statement-b"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="results">
            <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; margin-bottom: 24px; gap: 12px;">
                <h2 style="color: #1f2937; margin: 0;">Your Power Profile</h2>
                <button type="button" onclick="window.print()" style="
                    background-color: #081F5D;
                    color: white;
                    font-size: 0.9rem;
                    font-weight: 600;
                    padding: 12px 24px;
                    border: none;
                    border-radius: 8px;
                    cursor: pointer;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                    transition: all 0.2s;
                " onmouseover="this.style.backgroundColor='#05163d'" onmouseout="this.style.backgroundColor='#081F5D'">
                    üñ®Ô∏è Print/Save My Results
                </button>
            </div>
            
            <div style="margin-bottom: 48px;">
                <h3 style="color: #374151; margin-bottom: 16px; font-size: 1.125rem;">Power Mapping (Visual)</h3>
                <div style="width: 100%; overflow-x: auto;">
                    <canvas id="radarChart" width="500" height="500"></canvas>
                </div>
            </div>
            
            <div id="results-container"></div>
            
            <div class="reflection-box">
                <h3 class="reflection-title">Reflection Questions</h3>
                <ul class="reflection-list">
                    <li>Which power types are your strongest? How do you currently use these?</li>
                    <li>Which power types are underutilized? How might you develop or leverage them?</li>
                    <li>Is your power profile aligned with your role and goals?</li>
                    <li>What surprised you about your power perception?</li>
                    <li>How might others perceive your power differently than you do?</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const powerTypes = [
            {
                id: 'legitimate',
                name: 'Legitimate Power',
                description: 'Power derived from your formal position, role, or title',
                color: '#3b82f6',
                source: 'French & Raven (1959)'
            },
            {
                id: 'reward',
                name: 'Reward Power',
                description: 'Power to provide benefits, recognition, or positive outcomes',
                color: '#10b981',
                source: 'French & Raven (1959)'
            },
            {
                id: 'coercive',
                name: 'Coercive Power',
                description: 'Power to impose penalties, consequences, or sanctions',
                color: '#ef4444',
                source: 'French & Raven (1959)'
            },
            {
                id: 'expert',
                name: 'Expert Power',
                description: 'Power based on knowledge, skills, or specialized expertise',
                color: '#8b5cf6',
                source: 'French & Raven (1959)'
            },
            {
                id: 'referent',
                name: 'Referent Power',
                description: 'Power from personal characteristics, charisma, or relationships',
                color: '#f59e0b',
                source: 'French & Raven (1959)'
            },
            {
                id: 'informational',
                name: 'Informational Power',
                description: 'Power from access to or control of important information',
                color: '#06b6d4',
                source: 'Raven (1965)'
            },
            {
                id: 'charismatic',
                name: 'Charismatic Power',
                description: 'Power derived from exceptional personal qualities that inspire devotion',
                color: '#ec4899',
                source: 'Weber (1920s)'
            },
            {
                id: 'moral',
                name: 'Moral Power',
                description: 'Power from being perceived as ethically sound and morally credible',
                color: '#14b8a6',
                source: 'Mehta & Winship (2010)'
            },
            {
                id: 'convening',
                name: 'Convening Power',
                description: 'Power to bring diverse stakeholders together and facilitate collaboration',
                color: '#a855f7',
                source: 'Contemporary concept'
            }
        ];

        // Using only 2 statements per power type for pairs, but keeping all 3 for educational display
        const allStatements = {
            legitimate: [
                'People follow my direction because of my formal authority or position',
                'My role gives me the right to make decisions that others must follow',
                'I have official responsibilities that come with my title or position'
            ],
            reward: [
                'I can influence others by offering recognition or advancement opportunities',
                'I have the ability to provide resources, support, or benefits to others',
                'People seek my approval because I can impact their outcomes positively'
            ],
            coercive: [
                'I have the ability to impose consequences or penalties if needed',
                'People comply with my requests to avoid negative outcomes',
                'I can withhold resources or support if standards are not met'
            ],
            expert: [
                'Others seek my input because of my specialized knowledge or skills',
                'My technical expertise influences decisions in my area',
                'People trust my judgment because of my experience and competence'
            ],
            referent: [
                'People are influenced by me because they respect or admire me personally',
                'I build strong relationships that help me work effectively with others',
                'Others want to work with me because of who I am, not just what I can do'
            ],
            informational: [
                'I have access to important information that others need',
                'I control communication channels or data that influence decisions',
                'My ability to share or withhold information gives me influence'
            ],
            charismatic: [
                'People are drawn to my vision and feel inspired by my presence',
                'I can motivate others through my personal magnetism and energy',
                'Others follow me because of my compelling personality and confidence'
            ],
            moral: [
                'People trust me because they believe I act with integrity and ethical principles',
                'My perceived moral standing gives me credibility and influence',
                'Others follow my lead because they see me as doing what is right'
            ],
            convening: [
                'I have the ability to bring together diverse groups or stakeholders',
                'People look to me to facilitate conversations and build consensus',
                'I can create spaces where different parties collaborate effectively'
            ]
        };
        
        // Use only first 2 statements for creating pairs
        const statementsForPairs = {};
        Object.keys(allStatements).forEach(key => {
            statementsForPairs[key] = allStatements[key].slice(0, 2);
        });

        // Generate strategic pairs using 2 statements per power type
        let pairs = [];
        
        // Create statement pool: 2 statements √ó 9 power types = 18 statements (for pairs only)
        let allStatementsPool = [];
        powerTypes.forEach(type => {
            statementsForPairs[type.id].forEach(statement => {
                allStatementsPool.push({
                    statement: statement,
                    type: type.id
                });
            });
        });
        
        // Generate all possible pairs (18 choose 2 = 153 pairs)
        let allPossiblePairs = [];
        for (let i = 0; i < allStatementsPool.length; i++) {
            for (let j = i + 1; j < allStatementsPool.length; j++) {
                // Don't pair statements from the same power type
                if (allStatementsPool[i].type !== allStatementsPool[j].type) {
                    allPossiblePairs.push({
                        a: allStatementsPool[i],
                        b: allStatementsPool[j]
                    });
                }
            }
        }
        
        // Strategic sampling: ensure each statement appears roughly equally
        // We'll aim for 54 pairs (each statement appears 6 times on average)
        const targetPairs = 54;
        const statementCounts = {};
        allStatementsPool.forEach((_, i) => statementCounts[i] = 0);
        
        // Shuffle all possible pairs
        allPossiblePairs = allPossiblePairs.sort(() => Math.random() - 0.5);
        
        // Select pairs while balancing statement usage
        for (let pair of allPossiblePairs) {
            if (pairs.length >= targetPairs) break;
            
            const aIndex = allStatementsPool.findIndex(s => s.statement === pair.a.statement && s.type === pair.a.type);
            const bIndex = allStatementsPool.findIndex(s => s.statement === pair.b.statement && s.type === pair.b.type);
            
            // Only add if neither statement is overused (cap at 7 to keep it balanced)
            if (statementCounts[aIndex] < 7 && statementCounts[bIndex] < 7) {
                pairs.push(pair);
                statementCounts[aIndex]++;
                statementCounts[bIndex]++;
            }
        }
        
        // Final shuffle
        pairs = pairs.sort(() => Math.random() - 0.5);
        
        let currentPairIndex = 0;
        let selectedOption = null;
        let powerScores = {};
        
        // Initialize scores
        powerTypes.forEach(type => {
            powerScores[type.id] = 0;
        });
        
        // Display total pairs
        document.getElementById('total-pairs').textContent = pairs.length;
        
        function loadPair() {
            if (currentPairIndex >= pairs.length) {
                showResults();
                return;
            }
            
            const pair = pairs[currentPairIndex];
            document.getElementById('statement-a').textContent = pair.a.statement;
            document.getElementById('statement-b').textContent = pair.b.statement;
            document.getElementById('current-pair').textContent = currentPairIndex + 1;
            
            // Update progress bar
            const progress = ((currentPairIndex) / pairs.length) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
            
            // Reset selection state
            selectedOption = null;
        }
        
        function selectOption(option) {
            selectedOption = option;
            
            // Visual feedback
            const optionA = document.getElementById('option-a');
            const optionB = document.getElementById('option-b');
            
            if (optionA) optionA.classList.remove('selected');
            if (optionB) optionB.classList.remove('selected');
            
            const selectedEl = document.getElementById('option-' + option);
            if (selectedEl) selectedEl.classList.add('selected');
            
            // Auto-advance after brief delay for visual feedback
            setTimeout(() => {
                nextPair();
            }, 300);
        }
        
        function nextPair() {
            if (!selectedOption) return;
            
            const pair = pairs[currentPairIndex];
            
            // Record the choice
            if (selectedOption === 'a') {
                powerScores[pair.a.type]++;
            } else {
                powerScores[pair.b.type]++;
            }
            
            currentPairIndex++;
            
            // Clear selection immediately before loading next pair
            const optionA = document.getElementById('option-a');
            const optionB = document.getElementById('option-b');
            if (optionA) optionA.classList.remove('selected');
            if (optionB) optionB.classList.remove('selected');
            
            if (currentPairIndex < pairs.length) {
                // Small delay to ensure DOM updates
                setTimeout(() => {
                    loadPair();
                }, 50);
            } else {
                showResults();
            }
        }
        
        function showResults() {
            document.getElementById('assessment').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            
            // Calculate percentages
            const maxScore = Math.max(...Object.values(powerScores));
            const results = powerTypes.map(type => ({
                ...type,
                score: powerScores[type.id],
                percentage: maxScore > 0 ? ((powerScores[type.id] / maxScore) * 100).toFixed(1) : 0
            })).sort((a, b) => b.score - a.score);
            
            renderResults(results);
            drawRadarChart(results);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function renderResults(results) {
            const container = document.getElementById('results-container');
            let html = '<h3 style="color: #374151; margin-bottom: 16px; font-size: 1.125rem;">Detailed Breakdown (Ranked by Score)</h3>';
            
            const maxScore = Math.max(...results.map(r => r.score));
            
            results.forEach((type, index) => {
                html += `
                    <div class="power-card" style="border-color: ${type.color}">
                        <div class="power-header">
                            <div class="power-title-section">
                                <div class="color-dot" style="background-color: ${type.color}"></div>
                                <div>
                                    <div class="power-name">${type.name}</div>
                                    <div class="power-source">${type.source}</div>
                                </div>
                            </div>
                            <div class="power-score">
                                <span class="score-number">${type.score}</span>
                                <span class="score-total"> selections</span>
                            </div>
                        </div>
                        
                        <div class="power-description">${type.description}</div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${maxScore > 0 ? (type.score / maxScore) * 100 : 0}%; background-color: ${type.color}"></div>
                            </div>
                            <span class="interpretation" style="color: ${type.color}">${type.percentage}%</span>
                        </div>
                        
                        <div class="questions-box">
                            <div class="questions-title">Statements for this power type:</div>
                            <ul class="questions-list">
                                ${allStatements[type.id].map(q => `<li>${q}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function drawRadarChart(results) {
            const canvas = document.getElementById('radarChart');
            const ctx = canvas.getContext('2d');
            
            const isMobile = window.innerWidth < 768;
            const size = isMobile ? Math.min(window.innerWidth - 40, 400) : 500;
            canvas.width = size;
            canvas.height = size;
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const maxRadius = isMobile ? size * 0.32 : 180;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const maxScore = Math.max(...results.map(r => r.score));
            const scores = results.map(type => ({
                name: type.name.replace(' Power', ''),
                score: maxScore > 0 ? type.score / maxScore * 5 : 0,
                color: type.color
            }));
            
            const numPoints = scores.length;
            const angleStep = (Math.PI * 2) / numPoints;
            
            // Draw grid
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            for (let i = 1; i <= 5; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, (maxRadius / 5) * i, 0, Math.PI * 2);
                ctx.stroke();
            }
            
            // Draw axes
            scores.forEach((item, i) => {
                const angle = angleStep * i - Math.PI / 2;
                const x = centerX + Math.cos(angle) * maxRadius;
                const y = centerY + Math.sin(angle) * maxRadius;
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
            });
            
            // Draw labels
            ctx.font = isMobile ? '10px Arial' : '12px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            scores.forEach((item, i) => {
                const angle = angleStep * i - Math.PI / 2;
                const labelDistance = isMobile ? maxRadius + 35 : maxRadius + 40;
                const labelX = centerX + Math.cos(angle) * labelDistance;
                const labelY = centerY + Math.sin(angle) * labelDistance;
                
                ctx.beginPath();
                ctx.fillStyle = item.color;
                ctx.arc(labelX, labelY - (isMobile ? 15 : 18), isMobile ? 4 : 5, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#374151';
                const words = item.name.split(' ');
                if (words.length > 1) {
                    ctx.fillText(words[0], labelX, labelY - 2);
                    ctx.fillText(words[1] || '', labelX, labelY + (isMobile ? 10 : 12));
                } else {
                    ctx.fillText(item.name, labelX, labelY);
                }
            });
            
            // Draw polygon
            ctx.beginPath();
            scores.forEach((item, i) => {
                const angle = angleStep * i - Math.PI / 2;
                const radius = (item.score / 5) * maxRadius;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.closePath();
            
            const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, maxRadius);
            gradient.addColorStop(0, 'rgba(8, 31, 93, 0.3)');
            gradient.addColorStop(1, 'rgba(8, 31, 93, 0.1)');
            ctx.fillStyle = gradient;
            ctx.fill();
            
            ctx.strokeStyle = '#081F5D';
            ctx.lineWidth = 2.5;
            ctx.stroke();
            
            // Draw points
            scores.forEach((item, i) => {
                const angle = angleStep * i - Math.PI / 2;
                const radius = (item.score / 5) * maxRadius;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                ctx.beginPath();
                ctx.fillStyle = '#081F5D';
                ctx.arc(x, y, isMobile ? 4 : 5, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.stroke();
            });
        }
        
        // Initialize
        window.addEventListener('DOMContentLoaded', function() {
            loadPair();
        });
    </script>
</body>
</html>
